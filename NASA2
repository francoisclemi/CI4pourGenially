<!DOCTYPE html>
<html>
<head>
    <h2>NASA FIRMS et Fermes</h2>
    Latitude: <input type="number" id="latitude" placeholder="Latitude" step="any"><br>
    Longitude: <input type="number" id="longitude" placeholder="Longitude" step="any"><br>
    <button onclick="addFireMarker()">Ajouter Feu</button>
    <button onclick="addFarmMarker()">Ajouter Ferme</button>
    Nom de la ferme: <input type="text" id="farmName" placeholder="Nom de la ferme"><br>

    <title>Carte avec fond Satellite</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <style>
        #map {
            height: 500px;
            width: 100%;
        }
    </style>
</head>
<body>

<div id="map"></div>

<script>
    // Initialisation de la carte
    var map = L.map('map').setView([0, 0], 2);

    // Ajout du fond de carte satellite
    L.tileLayer('https://api.maptiler.com/maps/satellite/{z}/{x}/{y}.jpg?key=cg1oTGylkVWBYghNwXph', {
        attribution: '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>'
    }).addTo(map);

    // Icône de carré rouge pour les feux
    var fireIcon = L.divIcon({
        className: 'fire-icon',
        html: '<div style="width: 15px; height: 15px; background-color: red;"></div>',
        iconSize: [15, 15]
    });

    // Icône épingle bleue standard pour les fermes
    var farmIcon = L.icon({
        iconUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34]
    });

    // Fonction pour ajouter un marqueur de feu
    function addFireMarker() {
        var lat = parseFloat(document.getElementById('latitude').value);
        var lon = parseFloat(document.getElementById('longitude').value);
        var fireDate = new Date().toISOString().split('T')[0]; // Date actuelle

        if (!isNaN(lat) && !isNaN(lon)) {
            L.marker([lat, lon], {icon: fireIcon}).addTo(map)
                .bindPopup("Feu détecté à la date : " + fireDate + "<br>Position : " + lat + ", " + lon)
                .openPopup();
            map.setView([lat, lon], 10);
        } else {
            alert("Veuillez entrer des coordonnées valides.");
        }
    }

    // Fonction pour ajouter un marqueur de ferme
    function addFarmMarker() {
        var lat = parseFloat(document.getElementById('latitude').value);
        var lon = parseFloat(document.getElementById('longitude').value);
        var farmName = document.getElementById('farmName').value || "Ferme sans nom";

        if (!isNaN(lat) && !isNaN(lon)) {
            L.marker([lat, lon], {icon: farmIcon}).addTo(map)
                .bindPopup("Nom de la ferme : " + farmName + "<br>Position : " + lat + ", " + lon)
                .openPopup();
            map.setView([lat, lon], 10);
        } else {
            alert("Veuillez entrer des coordonnées valides.");
        }
    }

    // Exemple de données pour feux et fermes
    var fireData = [
        {latitude: -20.02849, longitude: -42.8816, date: "2024-07-01"},
        {latitude: -19.77589, longitude: -48.27407, date: "2024-07-01"}
    ];

    var farmData = [
        {latitude: -19.50000, longitude: -47.00000, name: "Ferme de l'Est"},
        {latitude: -20.10000, longitude: -43.50000, name: "Ferme des Collines"}
    ];

    // Ajouter des marqueurs pour chaque feu
    fireData.forEach(function(row) {
        L.marker([row.latitude, row.longitude], {icon: fireIcon}).addTo(map)
            .bindPopup("Feu détecté le : " + row.date + "<br>Position : " + row.latitude + ", " + row.longitude);
    });

    // Ajouter des marqueurs pour chaque ferme
    farmData.forEach(function(row) {
        L.marker([row.latitude, row.longitude], {icon: farmIcon}).addTo(map)
            .bindPopup("Nom de la ferme : " + row.name + "<br>Position : " + row.latitude + ", " + row.longitude);
    });

</script>

</body>
</html>
