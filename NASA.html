<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carte des feux de forêt</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <style>
    #map {
      height: 600px;
    }
    .button-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .month-button {
      padding: 10px;
      font-size: 14px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div>
    <label for="latitude">Latitude :</label>
    <input type="number" id="latitude" step="0.0001" value="-10.7435">
    <label for="longitude">Longitude :</label>
    <input type="number" id="longitude" step="0.0001" value="-59.3761">
    <button onclick="zoomToCoordinates()">Zoom sur la zone</button>
  </div>
  <div class="button-container">
    <button class="month-button" onclick="updateMap(2023)">2023 - Tous les feux</button>
    <button class="month-button" onclick="updateMap(2022)">2022 - Tous les feux</button>
  </div>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script>
    // Initialisation de la carte Leaflet
    var map = L.map('map').setView([-10.7435, -59.3761], 13);

    // Ajout du fond de carte
    L.tileLayer('https://api.maptiler.com/maps/satellite/{z}/{x}/{y}.jpg?key=cg1oTGylkVWBYghNwXph', {
      attribution: '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>'
    }).addTo(map);

    // Fonction pour zoomer sur les coordonnées entrées
    function zoomToCoordinates() {
      var lat = parseFloat(document.getElementById('latitude').value);
      var lon = parseFloat(document.getElementById('longitude').value);
      map.setView([lat, lon], 13); // Zoom sur la zone à un niveau de zoom de 5
    }

    // Fonction pour ajouter les feux de chaque mois d'une année
    function updateMap(year) {
      var months = [
        { month: 0, name: "Janvier" },
        { month: 1, name: "Février" },
        { month: 2, name: "Mars" },
        { month: 3, name: "Avril" },
        { month: 4, name: "Mai" },
        { month: 5, name: "Juin" },
        { month: 6, name: "Juillet" },
        { month: 7, name: "Août" },
        { month: 8, name: "Septembre" },
        { month: 9, name: "Octobre" },
        { month: 10, name: "Novembre" },
        { month: 11, name: "Décembre" }
      ];

      months.forEach(function(month) {
        var startDate = new Date(year, month.month, 1);
        var endDate = new Date(year, month.month + 1, 0);
        
        var startDateFormatted = startDate.toISOString().split('T')[0];
        var endDateFormatted = endDate.toISOString().split('T')[0];

        // URL WMS pour récupérer les feux
        var wmsUrl = `https://firms.modaps.eosdis.nasa.gov/mapserver/wms/fires/ba985b05872ec63f614928c2d93ff589/fires_viirs_7/`;
        var fireLayer = L.tileLayer.wms(wmsUrl, {
          layers: 'FIRMS:GFO_ACTIVE_FIRES',
          format: 'image/png',
          transparent: true,
          time: `${startDateFormatted}/${endDateFormatted}`,
          attribution: 'FIRMS Fire Data'
        });

        fireLayer.addTo(map);
      });
    }
  </script>
</body>
</html>
